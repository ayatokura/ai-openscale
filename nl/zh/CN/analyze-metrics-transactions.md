---

copyright:
  years: 2018, 2019
lastupdated: "2019-06-28"

keywords: metrics, monitoring, custom metrics, thresholds

subcollection: ai-openscale

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:tip: .tip}
{:important: .important}
{:note: .note}
{:pre: .pre}
{:codeblock: .codeblock}
{:screen: .screen}

# 分析度量和事务 ![beta 标签](images/beta.png)
{: #anlz_metrics}

可以使用 {{site.data.keyword.aios_full}} 通过各种方法来分析度量和交易。
{: shortdesc}

## 公平性度量
{: #anlz_metrics_fairness}

使用公平性监视来确定您的模型生成的结果对于受监视组是否公平。启用了公平性监视时，缺省情况下，每小时生成一组度量。您也可以通过单击**立即检查质量**按钮或使用 Python 客户机，根据需要来生成这些度量。

公平性度量的计算是基于以下信息：

- 载荷数据的评分。

为了进行适当的监视，每个评分请求也应该记录在 {{site.data.keyword.aios_short}} 中。 对于 {{site.data.keyword.pm_full}} 引擎，将自动进行载荷数据记录。

对于其他机器学习引擎，可以使用 Python 客户机或 REST API 来提供载荷数据。

对于除 {{site.data.keyword.pm_full}} 以外的机器学习引擎，公平性监视会在受监视的部署上创建其他评分请求。
{: note}

您可以在 {{site.data.keyword.aios_short}} 仪表板上查看一段时间内的所有度量值：

![显示漂移阈值下限的公平性度量图表](images/fairness_metrics_001.png)

您可以查看相关详细信息，例如有利结果和不利结果：

![公平性详细信息](images/fairness_metrics_002.png)

您可以查看详细事务：

![显示事务列表的公平性图表](images/fairness_metrics_003.png)

您可以查看建议的去偏差评分端点：

![去偏差评分端点详细信息](images/fairness_metrics_004.png)

### 支持的公平性度量
{: #anlz_metrics_supfairmets}

{{site.data.keyword.aios_short}} 支持以下公平性度量：

#### 组的公平性
{: #anlz_metrics_supfairmets_group}

- **描述**：模型倾向于在组之间传递有利结果。
- **缺省阈值**：下限 = 80%
- **缺省建议**：去偏差评分端点，可供在您的业务应用程序中用于从部署模型中接收去偏差响应。
- **问题类型**：全部
- **数据类型**：结构化
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：可用

### 受支持公平性的详细信息
{: #anlz_metrics_supfairdets}

{{site.data.keyword.aios_short}} 支持以下公平性度量的以下详细信息：

- 每个组的有利百分比
- 所有公平性组的公平性平均值

  差别影响比率 =（受监视组中有利结果的百分比）/（引用组中有利结果的百分比）

- 每个受监视组的数据分布
- 载荷数据的分布


<!---
BTW, I propose to use screenshots with data from FastPath.
Source monitored group or referenced group
Source of bias is also in fairness metrics
--->


## 质量度量
{: #anlz_metrics_quality}

使用质量监视来确定模型预测结果的精确程度。启用了质量监视时，缺省情况下，每小时生成一组度量。您也可以通过单击**立即检查质量**按钮或使用 Python 客户机，根据需要来生成这些度量。

质量度量的计算是基于以下信息：

- 手动标注的反馈数据，
- 针对这些数据所监视的部署响应

为了进行适当的监视，必须定期将反馈数据记录到 {{site.data.keyword.aios_short}} 中。可使用“添加反馈数据”选项或使用 Python 客户机或 REST API 来提供反馈数据。

对于除 {{site.data.keyword.aios_short}} 以外的机器学习引擎（如 Microsoft Azure ML Studio 或 Amazon Sagemaker ML），质量监视会在受监视的部署上创建其他评分请求。
{: note}

您可以在 {{site.data.keyword.aios_short}} 仪表板上查看一段时间内的所有度量值：

![显示 ROC 下面积漂移的质量度量图表](images/quality_metrics_001.png)


要复审适用于某些度量的相关详细信息（例如用于二元和多类分类的混淆矩阵），请单击图表。

![质量度量的详细信息表](images/quality_metrics_002.png)

### 支持的质量度量
{: #anlz_metrics_supqualdets}

{{site.data.keyword.aios_short}} 支持以下质量度量：

#### ROC 下的面积
{: #anlz_metrics_supqualdets_roc}

- **描述**：查全率曲线和误报率曲线下的面积
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：二元分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### PR 下的面积
{: #anlz_metrics_supqualdets_pr}

- **描述**：精度和查全率曲线下的面积
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：二元分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 可解释方差的比例
{: #anlz_metrics_supqualdets_var}

- **描述**：“可解释方差的比例”是指可解释方差与目标方差之比。 “预期方差”是指目标方差与预测误差方差之间的差异。
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：回归
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：无

#### 平均绝对误差
{: #anlz_metrics_supqualdets_abserror}

- **描述**：模型预测与目标值之间的绝对差的平均值
- **缺省阈值**：上限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在恶化。反馈数据正在变得明显不同于训练数据。
   - **下降趋势**：下降趋势表明度量正在改善。 这意味着，模型再训练是有效的。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：回归
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：无

#### 均方误差
{: #anlz_metrics_supqualdets_squerror}

- **描述**：模型预测与目标值之间的平方差的平均值
- **缺省阈值**：上限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在恶化。反馈数据正在变得明显不同于训练数据。
   - **下降趋势**：下降趋势表明度量正在改善。 这意味着，模型再训练是有效的。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：回归
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：无

#### R 平方
{: #anlz_metrics_supqualdets_r_squared}

- **描述**：以下两个方差之间的差异比率：目标方差，预测误差和目标方差之间的方差
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：回归
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：无

#### 均方根误差
{: #anlz_metrics_supqualdets_squ_errors_mean}

- **描述**：模型预测值与目标值之间平方差平均值的平方根
- **缺省阈值**：上限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在恶化。反馈数据正在变得明显不同于训练数据。
   - **下降趋势**：下降趋势表明度量正在改善。 这意味着，模型再训练是有效的。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：回归
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：无

#### 准确性
{: #anlz_metrics_supqualdets_acc}

- **描述**：正确预测的比例
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：二元分类和多类分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 加权真正率 (wTPR)
{: #anlz_metrics_supqualdets_wtpr}

- **描述**：权重等于类概率的类 TPR 的加权平均值
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：多类分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 真正率 (TPR)
{: #anlz_metrics_supqualdets_tpr}

- **描述**：正类中正确预测的比例
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：二元分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 加权误报率 (wFPR)
{: #anlz_metrics_supqualdets_wfpr_weighted}

- **描述**：权重等于类概率的类 FPR 的加权平均值
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：多类分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 误报率 (FPR)
{: #anlz_metrics_supqualdets_fpr_false}

- **描述**：正类中不正确预测的比例
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：二元分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 加权查全率
{: #anlz_metrics_supqualdets_weighted_recall}

- **描述**：权重等于类概率的查全率的加权平均值
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：多类分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 查全率
{: #anlz_metrics_supqualdets_recall}

- **描述**：正类中正确预测的比例
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：二元分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 加权查准率
{: #anlz_metrics_supqualdets_wgth_prec}

- **描述**：权重等于类概率的查准率的加权平均值
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：多类分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 查准率
{: #anlz_metrics_supqualdets_precision}

- **描述**：正类中正确预测的比例
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：二元分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 加权 F1 度量
{: #anlz_metrics_supqualdets_wght_f1-measure}

- **描述**：权重等于类概率的 F1 度量的加权平均值
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：多类分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### F1 度量
{: #anlz_metrics_supqualdets_f1-measr}

- **描述**：精度和查全率的调和均值
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：二元分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：混淆矩阵

#### 对数损失
{: #anlz_metrics_supqualdets_log_loss}

- **描述**：对数目标类概率（置信度）的平均值。也称为预期对数似然。
- **缺省阈值**：下限 = 80%
- **缺省建议**：
   - **上升趋势**：上升趋势表明度量正在改善。这意味着，模型再训练是有效的。
   - **下降趋势**：下降趋势表明度量正在恶化。 反馈数据正在变得明显不同于训练数据。
   - **错误或不规则的变体**：错误或不规则的变体表明反馈数据在不同求值期间不一致。 此时请增大质量监视器的最小样本大小。
- **问题类型**：二元分类和多类分类
- **图表值**：时间范围内的最后一个值
- **度量详细信息是否可用**：无

### 支持的质量详细信息
{: #anlz_metrics_supqualdets_suppr_dets}

{{site.data.keyword.aios_short}} 支持以下质量度量的以下详细信息：

#### 混淆矩阵
{: #anlz_metrics_supqualdets_confusion}

混淆矩阵可帮助您了解受监视部署响应对于哪些反馈数据来说正确，以及对于哪些反馈数据不正确。

## 性能度量
{: #anlz_metrics_performance}

使用性能监视可了解部署处理数据记录的速度。可在选择要由 {{site.data.keyword.aios_short}} 跟踪和监视的部署时启用性能监视。

性能度量的计算是基于以下信息：

- 评分载荷数据

为了进行适当的监视，每个评分请求也应该记录在 {{site.data.keyword.aios_short}} 中。 对于 {{site.data.keyword.pm_full}} 引擎，将自动进行载荷数据记录。对于其他机器学习引擎，可以使用Python客户机或REST API来提供载荷数据。 性能监视不会在受监视的部署上创建任何其他评分请求。

您可以在 {{site.data.keyword.aios_short}} 仪表板上查看一段时间内的性能度量值：

![性能图表](images/performance_metrics_001.png)

### 支持的性能度量
{: #anlz_metrics_performance_supp_quality_mets}

{{site.data.keyword.aios_short}} 支持以下性能度量：

#### 吞吐量
{: #anlz_metrics_performance_supp_quality_mets_through}

- **描述**：特定时间范围内每分钟的评分请求平均数量
- **缺省阈值**：不适用
- **缺省建议**：不适用
- **问题类型**：全部
- **图表值**：时间范围内的平均值
- **度量详细信息是否可用**：无

## 载荷数据分析
{: #anlz_metrics_payload}

可以通过以下任一方法来分析在所选数据范围内发送到部署的评分载荷：

- 通过查看每个类中的预测类和置信度分布
   
   ![此图表按置信度分布映射预测](images/by_confidence.png)
   
- 通过定制图表（选择特性、预测类和置信度中的一个）
   
   ![此图表按特征年龄显示性别的特征预测](images/by_custom_chart.png)

