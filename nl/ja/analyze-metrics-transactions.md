---

copyright:
  years: 2018, 2019
lastupdated: "2019-06-28"

keywords: metrics, monitoring, custom metrics, thresholds

subcollection: ai-openscale

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:tip: .tip}
{:important: .important}
{:note: .note}
{:pre: .pre}
{:codeblock: .codeblock}
{:screen: .screen}

# 指標とトランザクションの分析 ![ベータ・タグ](images/beta.png)
{: #anlz_metrics}

{{site.data.keyword.aios_full}} を使用すると、さまざまな手段を使用して指標とトランザクションを分析できます。
{: shortdesc}

## 公平性指標
{: #anlz_metrics_fairness}

公平性モニタリングを使用して、モデルによって作成された結果が、モニター対象グループにとって公平かどうかを判別します。 公平性モニタリングを有効にすると、デフォルトでは 1 時間ごとに指標のセットが生成されます。 これらの指標は、**「今すぐ品質を評価」**」ボタンをクリックするか、Python クライアントを使用することにより、オンデマンドで生成できます。

公平性指標は、以下の情報に基づいて計算されます。

- ペイロード・データの評価

適切なモニタリングのために、すべての評価要求も {{site.data.keyword.aios_short}} でログ記録する必要があります。 {{site.data.keyword.pm_full}} エンジンの場合、ペイロード・データのロギングは自動化されています。

その他の機械学習エンジンの場合、Python クライアントか REST API を使用してペイロード・データを提供できます。

{{site.data.keyword.pm_full}} 以外の機械学習エンジンの場合、公平性モニタリングにより、モニター対象のデプロイメントに関する追加の評価要求が作成されます。
{: note}

{{site.data.keyword.aios_short}} ダッシュボードで、すべての指標値を経時的に確認できます。

![しきい値を下回るドリフトが表示された公平性指標グラフ](images/fairness_metrics_001.png)

以下のように、好ましい結果と好ましくない結果などの、関連した詳細情報を検討できます。

![公平性の詳細](images/fairness_metrics_002.png)

以下のように、詳細トランザクションを表示できます。

![トランザクションのリストが表示された、公平性に関するグラフ](images/fairness_metrics_003.png)

推奨されるバイアス緩和済みの評価エンドポイントを表示できます。

![バイアス緩和済みの評価エンドポイントの詳細](images/fairness_metrics_004.png)

### サポートされている公平性指標
{: #anlz_metrics_supfairmets}

以下の公平性指標が {{site.data.keyword.aios_short}} によってサポートされています。

#### グループに関する公平性
{: #anlz_metrics_supfairmets_group}

- **説明**: モデルがあるグループに対して別のグループよりも好ましい結果を出す傾向です。
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**: デプロイされているモデルからバイアス緩和済みの応答を受信するために、ビジネス・アプリケーションで使用できるバイアス緩和済みの評価エンドポイント。
- **問題タイプ**: すべて
- **データ・タイプ**: 構造化
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: あり

### サポートされている公平性の詳細
{: #anlz_metrics_supfairdets}

以下の公平性指標に関する詳細が {{site.data.keyword.aios_short}} によってサポートされています。

- グループごとの好ましい割合
- すべての公平性グループに関する公平性の平均

  差別的効果率 = (モニター対象グループ内の好ましい結果の割合) / (参照グループ内の好ましい結果の割合)

- モニター対象グループごとのデータの分布
- ペイロード・データの分布


<!---
BTW, I propose to use screenshots with data from FastPath.
Source monitored group or referenced group
Source of bias is also in fairness metrics
--->


## 品質指標
{: #anlz_metrics_quality}

モデル性能モニタリングを使用して、モデルがどの程度正確な結果を予測するかを判別します。 モデル性能モニタリングを有効にすると、デフォルトでは 1 時間ごとに指標のセットが生成されます。 これらの指標は、**「今すぐ品質を評価」**」ボタンをクリックするか、Python クライアントを使用することにより、オンデマンドで生成できます。

品質指標は、以下の情報に基づいて計算されます。

- 手動でラベル付けするフィードバック・データ
- これらのデータに関するモニター対象デプロイメントの応答

適切なモニタリングのために、フィードバック・データを {{site.data.keyword.aios_short}} に定期的にログ記録する必要があります。 フィードバック・データを提供するには、「フィードバック・データの追加」オプションを使用するか、Python クライアントまたは REST API を使用します。

Microsoft Azure ML Studio や Amazon Sagemaker ML などの、{{site.data.keyword.aios_short}} 以外の機械学習エンジンの場合、モデル性能モニタリングにより、モニター対象のデプロイメントに関する追加の評価要求が作成されます。
{: note}

{{site.data.keyword.aios_short}} ダッシュボードで、すべての指標値を経時的に確認できます。

![ROC 曲線下面積のドリフトが表示された品質指標グラフ](images/quality_metrics_001.png)


一部の指標について使用できる、関連する詳細 (二項分類と多項分類の混同行列など) を確認するには、グラフをクリックします。

![品質指標の詳細テーブル](images/quality_metrics_002.png)

### サポートされている品質指標
{: #anlz_metrics_supqualdets}

以下の品質指標が {{site.data.keyword.aios_short}} によってサポートされています。

#### ROC 曲線下面積
{: #anlz_metrics_supqualdets_roc}

- **説明**: 再現率と偽陽性の比率を示す曲線の下の領域です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 二項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### PR 曲線下面積
{: #anlz_metrics_supqualdets_pr}

- **説明**: 適合率と再現率を示す曲線の下の領域です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 二項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 因子寄与率
{: #anlz_metrics_supqualdets_var}

- **説明**: 因子寄与率とは、説明された差異とターゲット差異の比率を表します。 説明された差異とは、ターゲット差異と予測誤差の差異の間の差異です。
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 回帰
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: なし

#### 平均絶対誤差
{: #anlz_metrics_supqualdets_abserror}

- **説明**: モデル予測とターゲット値の絶対差の平均
- **デフォルトのしきい値**: 上限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **下降傾向**: 下降傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 回帰
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: なし

#### 平均二乗誤差
{: #anlz_metrics_supqualdets_squerror}

- **説明**: モデル予測とターゲット値の差を二乗した平均
- **デフォルトのしきい値**: 上限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **下降傾向**: 下降傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 回帰
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: なし

#### R2 (決定係数)
{: #anlz_metrics_supqualdets_r_squared}

- **説明**: ターゲット差異と、ターゲット差異に対する予測誤差の間の差異の比率です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 回帰
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: なし

#### 平均平方二乗誤差
{: #anlz_metrics_supqualdets_squ_errors_mean}

- **説明**: モデル予測とターゲット値の差を二乗した平均の平方根
- **デフォルトのしきい値**: 上限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **下降傾向**: 下降傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 回帰
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: なし

#### 正解率
{: #anlz_metrics_supqualdets_acc}

- **説明**: 正確な予測の比率
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 二項分類と多項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 加重真陽性率 (wTPR)
{: #anlz_metrics_supqualdets_wtpr}

- **説明**: 加重クラス TPR の加重平均は、クラス確率と同等です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 多項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 真陽性 (TPR)
{: #anlz_metrics_supqualdets_tpr}

- **説明**: 肯定クラスの予測で正しい予測をする比率です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 二項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 加重偽陽性率 (wFPR)
{: #anlz_metrics_supqualdets_wfpr_weighted}

- **説明**: 加重クラス FPR の加重平均は、クラス確率と同等です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 多項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 偽陽性率 (FPR)
{: #anlz_metrics_supqualdets_fpr_false}

- **説明**: 肯定クラスで正しくない予測をする比率です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 二項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 加重再現率
{: #anlz_metrics_supqualdets_weighted_recall}

- **説明**: 加重再現率の加重平均は、クラス確率と同等です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 多項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 再現率
{: #anlz_metrics_supqualdets_recall}

- **説明**: 肯定クラスで正しい予測をする比率です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 二項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 加重適合率
{: #anlz_metrics_supqualdets_wgth_prec}

- **説明**: 加重適合率の加重平均は、クラス確率と同等です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 多項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 適合率
{: #anlz_metrics_supqualdets_precision}

- **説明**: 肯定クラスの予測で正しい予測をする比率です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 二項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 加重 F1 値
{: #anlz_metrics_supqualdets_wght_f1-measure}

- **説明**: 加重 F1 値の加重平均は、クラス確率と同等です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 多項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### F1 値
{: #anlz_metrics_supqualdets_f1-measr}

- **説明**: 適合率と再現率の調和平均です
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 二項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: 混同行列

#### 対数損失
{: #anlz_metrics_supqualdets_log_loss}

- **説明**: ターゲット・クラス確率の対数の平均 (確信度)。 これは、予想対数尤度とも呼ばれます。
- **デフォルトのしきい値**: 下限 = 80%
- **デフォルトの推奨**:
   - **上昇傾向**: 上昇傾向は、指標が向上していることを示します。 これは、モデルの再訓練の効果が出ていることを意味します。
   - **下降傾向**: 下降傾向は、指標が悪化していることを示します。 フィードバック・データと訓練データの差異が明らかに広がっています。
   - **不規則または不定期変化**: 不規則変化または不定期変化は、フィードバック・データが各評価で一貫性がないことを示します。 モデル性能モニタリングの最小サンプル・サイズを増やしてください。
- **問題タイプ**: 二項分類と多項分類
- **グラフ値**: 時間フレーム内の最後の値
- **使用可能な指標の詳細**: なし

### サポートされている品質の詳細
{: #anlz_metrics_supqualdets_suppr_dets}

以下の品質指標に関する詳細が {{site.data.keyword.aios_short}} によってサポートされています。

#### 混同行列
{: #anlz_metrics_supqualdets_confusion}

混同行列は、モニター対象デプロイメントの応答が、どのフィードバック・データに関して正しく、どのフィードバック・データに関しては正しくないかを理解するのに役立ちます。

## パフォーマンス指標
{: #anlz_metrics_performance}

デプロイメントで処理されるデータ・レコードの速度を知るには、パフォーマンス・モニタリングを使用します。 {{site.data.keyword.aios_short}} で追跡し、モニターする対象のデプロイメントを選択すると、パフォーマンス・モニタリングが有効になります。

パフォーマンス指標は、以下の情報に基づいて計算されます。

- ペイロード・データの評価

適切なモニタリングのために、すべての評価要求も {{site.data.keyword.aios_short}} でログ記録する必要があります。 {{site.data.keyword.pm_full}} エンジンの場合、ペイロード・データのロギングは自動化されています。 その他の機械学習エンジンの場合、Python クライアントか REST API を使用してペイロード・データを提供できます。 パフォーマンス・モニタリングでは、モニター対象のデプロイメントに関する追加の評価要求は作成されません。

{{site.data.keyword.aios_short}} ダッシュボードで、パフォーマンス指標値を経時的に確認できます。

![パフォーマンスのグラフ](images/performance_metrics_001.png)

### サポートされているパフォーマンス指標
{: #anlz_metrics_performance_supp_quality_mets}

以下のパフォーマンス指標が {{site.data.keyword.aios_short}} によってサポートされています。

#### スループット
{: #anlz_metrics_performance_supp_quality_mets_through}

- **説明**: 特定の時間フレームにおける 1 分あたりの平均の評価要求数
- **デフォルトのしきい値**: 該当なし
- **デフォルトの推奨**: 該当なし
- **問題タイプ**: すべて
- **グラフ値**: 時間フレーム内の平均値
- **使用可能な指標の詳細**: なし

## ペイロード・データ分析
{: #anlz_metrics_payload}

以下のいずれかの方式で、選択されたデータの範囲内でデプロイメントに送信される評価ペイロードを分析できます。

- 予測クラスと各クラス内の確信度の分布を検討する
   
   ![確信度の分布別に予測をマップするグラフ](images/by_confidence.png)
   
- カスタム・グラフを使用する (特徴量、予測クラス、確信度の中から選択)
   
   ![特徴量「年齢」別に、性別に関する特徴量予測を表示するグラフ](images/by_custom_chart.png)

