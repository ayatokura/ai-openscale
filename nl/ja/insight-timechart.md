---

copyright:
  years: 2018, 2019
lastupdated: "2019-03-28"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:tip: .tip}
{:important: .important}
{:note: .note}
{:pre: .pre}
{:codeblock: .codeblock}
{:screen: .screen}

# 公平性、分当たりの平均要求数、および正確度のモニター
{: #itc-timechart}

時系列グラフには、個々のデプロイメントのモニター・データが表示されます。このグラフでは、過去 7 日間の公平性、分当たりの平均要求数、正確度が追跡されます。
{: shortdesc}

## デプロイメントのデータの表示
{: #itc-view}

ダッシュボードからデプロイメントを選択して、そのデプロイメントのモニター・データを表示します。モニター・データ・グラフの上部には、デプロイされたモデルに関する情報が表示されます。これには、モデルの公平性と正確度が最後に評価された時期、およびそれが次に評価される時期が含まれます。

![時系列グラフ](images/insight-time-chart.png)

アルゴリズム・チェックは、1 時間ごとでしか実行されないため、公平性と正確度をオンデマンドでチェックできるようにするボタンも用意されています。十分なペイロードの記録 (公平性) やフィードバックの記録 (正確度) を提供しないと、例えば、次のようなメッセージが表示されます。

![「正確度」ボタン](images/accuracy-button.png)

次に、グラフ内でマーカーを移動し、各時間の統計を表示します。この例では、選択された時刻は 9 月 18 日の中央標準時午後 1 時で、以下の統計を明らかにします。

  ![時系列グラフの詳細](images/insight-time-detail.png)

- ***公平性***: 3 つの公平性フィーチャーのうちの 2 つである車の価格と地域コードが、その承認のしきい値に達しました。3 つ目の公平性フィーチャーである年齢には、バイアスのフラグが立てられました。公平性がモニターされるフィーチャーの個々の集団について、予期されたいくつかの結果 (この場合は、承認対拒否のパーセンテージ) を表示することもできます。
- ***正確度***: 正確度メトリックの平均は 78% です。
- ***分当たりの平均要求数***: 中部標準時午後 1 時から 2 時までの間、平均で毎分 300 のレコードが処理されました。スループットが毎分計算され、1 時間にわたるその平均値がグラフに報告されます。

## 特定時間のデータの視覚化
{: #itc-data-visual}

特定の公平性統計の詳細を表示するには、選択した時間の**「詳細の表示 (View details)」**リンクをクリックします。

モニター対象フィーチャーのデータ・ポイントの視覚化が、選択した時間に開きます。前の例に続いて、年齢フィーチャー (バイアスのタグが付いています) が表示されます。

このページの上部にある 3 つのフィルター (「フィーチャー」、「日付」、および「時間」) に注意してください。これらを使用すると、別のフィーチャーや時間を選択して、詳細を確認できます。

  ![時系列グラフ](images/insight-data-detail.png)

### グラフの解釈
{: #itc-intp}

グラフには、以下のいくつかのことが表示されます。

- バイアスを経験している集団 (18 歳から 23 歳のお客様) を観察できます。グラフには、この集団の予期される結果のパーセンテージ (52%) も表示されます。

- このグラフには、準拠集団の予期される結果のパーセンテージ (70%) が表示されます。これは、すべての準拠集団の予期される結果の平均です。

- このグラフはバイアスの存在を示しています。これは、準拠集団の予期される結果のパーセンテージに対する 18 歳から 23 歳の集団の予期される結果のパーセンテージの比率が、しきい値を下回っているためです。つまり、0.52/0.7 = 0.74 で、これは、しきい値の 0.8 未満になります。

- グラフには、バイアス識別の分析が行われたペイロード・テーブルのデータにおける属性の特殊値ごとの参照値とモニター対象値の分布も表示されます。つまり、バイアス検出アルゴリズムによってペイロード・テーブルの最後の 1790 個のレコードが分析された場合、これらのうち 120 個のレコードではお客様の年齢が 18 歳から 23 歳の間であり、その分布のうち`承認`と`拒否`の結果が棒グラフで表されます。ペイロード・データの分布は、(参照値が表示されている場合でも) 公平性属性の特殊値ごとに表示されます。この情報を使用して、バイアスをモデルが受け取ったデータ量に関連付けることができます。

- グラフには、さらに、31 歳から 35 歳の集団が 91% の予期される結果を受け取ったことも示されています。これはバイアスの原因を示すもので、このグループのデータによって結果がゆがめられ、参照クラスの予期される結果のパーセンテージが増加したことを意味しています。この情報を使用すると、モデルをリトレーニングする際にアンダーサンプリングされた可能性のあるデータの部分を識別できます。

- その他にグラフに表示される重要事項として、手動によるラベル付けのために識別されたデータが含まれているテーブルの名前があります。アルゴリズムによって、モデルでバイアスが検出されるたびに、人間が手動で行うラベル付けのために送信できるデータ・ポイントも識別されます。その後、この手動でラベル付けされたデータを元のトレーニング・データとともに使用して、モデルをリトレーニングすることができます。このリトレーニングされたモデルには、バイアスがない可能性が高いです。手動のラベル付けテーブルは、{{site.data.keyword.aios_short}} インスタンスに関連付けられたデータベース内にあります。

## ランタイム・データとトレーニング・データ
{: #itc-rtsw}

ランタイム・データ / トレーニング・データのスイッチにより、トレーニングされたモデルと、バイアスの警告をトリガーしている実行時に収集されたデータとの間の相違を切り替えることができます。

![ランタイムとトレーニングの切り替え](images/runtime_train_data.png)

## トランザクションの表示
{: #itc-tra}

このオプションを使用すると、**「トランザクションの表示 (View transactions)」**ボタンをクリックしたときに、バイアスの原因となった個々のトランザクションを表示できます。

![トランザクションの表示](images/view_transactions.png)

デプロイメントがバイアスした状態で動作したトランザクションのリストが表示されます。任意のトランザクション ID の**「説明 (Explain)」**リンクをクリックし、「説明可能性 (Explainability)」タブでそのトランザクションに関する詳細を入手します。詳しくは、[説明可能性のモニター](/docs/services/ai-openscale-icp?topic=ai-openscale-icp-ie-ov)を参照してください。

**「すべてのトランザクション (All transactions)」**ビューを選択して、以下のように、選択したフィーチャー (この例では、年齢) および選択した期間 (この例では 2018 年 9 月 15 日午後 1 時) のすべてのトランザクションを表示します。

![トランザクションのリスト](images/transaction_list1.png)

**「バイアスのあるトランザクション (Biased transactions)」**ビューを選択して、バイアスのある結果を受け取ったトランザクションのサブセットのみを表示します。バイアスのあるトランザクションは、それぞれ、似て非なる (摂動された) トランザクションと比較されます。このような似て非なるトランザクションは、以下のように、モニター対象のフィーチャー (年齢) の値を変更して、バイアスのあるトランザクションの好ましい結果を得る方法を示します。

![バイアスのあるトランザクションのリスト](images/transaction_list2.png)

## 実動モデルとバイアスが除去されたモデル
{: #itc-prdb}

これら 2 つのタブを使用して、実動モデルと、{{site.data.keyword.aios_short}} で作成されたバイアスが除去されたモデルとの間で切り替えることができます。詳しくは、[バイアス除去機能の理解](/docs/services/ai-openscale?topic=ai-openscale-mf-monitor#mf-debias)を参照してください。

![ランタイムとトレーニングの切り替え](images/bias-debias.png)

**「バイアスが除去されたモデル (De-biased model)」**タブを選択すると、バイアスが除去されたモデルと実動モデルにおける変更点が表示されます。この例では、モデルの公平性は 74% から 93% に増加していますが、正確度では 1% の低下のみです。このグラフには、18 歳から 23 歳のグループの結果が改善されているという状況も反映されています。

![ランタイムとトレーニングの切り替え](images/insight-data-detail2.png)

### バイアス除去オプション
{: #itc-dbo}

- *パッシブ・バイアス除去 (Passive de-biasing)* - {{site.data.keyword.aios_short}} では、バイアス・チェックが行われると、モデルの動作を分析し、バイアスのある状態でモデルが動作しているデータを識別することによって、データのバイアス除去も行われます。

  {{site.data.keyword.aios_short}} は、その後、機械学習モデルを作成して、指定された新規データ・ポイントでそのモデルがバイアスのある状態で動作するかどうかを予測します。次に、{{site.data.keyword.aios_short}} はモデルが受け取ったデータを毎時間分析し、データがバイアスのある状態で動作していると {{site.data.keyword.aios_short}} が確認したデータ・ポイントを見つけます。そのようなデータ・ポイントの場合、公平性属性は少数から多数へと摂動を与えられ、摂動が与えられたデータが予測のために元のモデルに送信されます。この元のモデルの予測は、バイアスが除去された出力として使用されます。

  {{site.data.keyword.aios_short}} は、過去 1 時間にモデルが受け取ったすべてのデータについて、このバイアス除去を毎時間実行します。バイアスが除去された出力の公平性の計算も行われ、**「バイアスが除去されたモデル (De-biased model)」**タブにそれが表示されます。

- *アクティブ・バイアス除去 (Active de-biasing)* - アクティブ・バイアス除去では、ご使用のアプリケーションからバイアス除去 REST API エンドポイントを使用できます。この REST API エンドポイントは、ご使用のモデルを内部で呼び出して、その動作をチェックします。

  {{site.data.keyword.aios_short}} で、モデルがバイアスのある状態で動作していると確認された場合、前述のようにデータに摂動が与えられ、それが元のモデルに返送されます。摂動が与えられたデータに関する元のモデルの出力は、バイアスが除去された予測として返されます。{{site.data.keyword.aios_short}} は、元のモデルがバイアスのある状態で動作していないと判断すると、元のモデルの予測をバイアスが除去された予測として返します。したがって、この REST API エンドポイントを使用することで、ご使用のアプリケーションが、モデルのバイアスのある出力に基づいた決定を行うことがなくなります。

  **「バイアスが除去されたスコアリング・エンドポイント (Debiased Scoring Endpoint)」**リンクを使用して、バイアス除去 REST API のエンドポイントを見つけます。

  ![API エンドポイントのバイアス除去](images/insight-debias-api.png)
